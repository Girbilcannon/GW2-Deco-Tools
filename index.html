<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>GW2 Deco Tools v8.0.2</title>

  <!-- Strict CSP -->
  <meta http-equiv="Content-Security-Policy"
        content="
          default-src 'self';
          connect-src 'self' http://localhost:61337;
          script-src 'self';
          style-src 'self';
          img-src 'self' data:;
          object-src 'none';
          base-uri 'self';
          form-action 'self';
          frame-ancestors 'none';
        ">

  <meta name="referrer" content="no-referrer">
  <meta http-equiv="X-Content-Type-Options" content="nosniff">

  <link rel="stylesheet" href="style.css">
</head>

<body>

<!-- ==================================================
     HELPER STATUS
     ================================================== -->
<div id="helper-status">
  <span id="helper-dot" class="helper-dot"></span>
  <span id="helper-text">Checking helperâ€¦</span>
  <span class="helper-refresh">(refresh page to update)</span>
</div>

<!-- ==================================================
     THEME TOGGLE
     ================================================== -->
<div id="themeToggle">ðŸŒ™ Inquest Mode</div>

<div class="wrapper">

  <h1>GW2 Deco Tools</h1>

  <!-- ==================================================
       TABS
       ================================================== -->
  <div class="tabs">
    <button class="tab active" data-target="tool-mover">Deco Mover</button>
    <button class="tab" data-target="tool-interactive-mover">Interactive Move Tool (Beta)</button>
    <button class="tab" data-target="tool-counter">Deco Counter</button>
    <button class="tab" data-target="tool-swap">Map Swap</button>
    <button class="tab" data-target="tool-merger">Deco Merger</button>
    <button class="tab" data-target="tool-extract">Deco Extraction</button>
    <button class="tab" data-target="tool-inspector">XML Inspector</button>
    <button class="tab" data-target="tool-about">About / Credits</button>
  </div>

  <!-- ==================================================
       DECO MOVER
       ================================================== -->
  <div id="tool-mover" class="tool-pane active">

    <div class="section-title">Deco Mover Tool</div>

    <div class="note-box">
      Moves all decorations in the main XML by shifting them from a source location to a destination location.
      To get a Start and End location, simply clear your decorations, place a box or any object in its rough location,
      save it as a new file, move the box to a new spot, and then save a new file for end location.
      <br><br>

      <strong>WORLD ZERO CHECK BOX:</strong><br>
      Moves decorations to absolute world center by averaging positions.
      Helpful when a layout is out of bounds or after a map swap.
      <br><br>

      <em>
        World Zero may be underground on some maps. Safe Zone can offset placement
        slightly upward and southward (especially for Guild Halls).
      </em>
    </div>

    <div class="checkbox-row">
      <label>
        <input type="checkbox" id="mover-worldzero">
        Bring Deco to World Zero
      </label>
    </div>

    <div class="checkbox-row">
      <label class="mover-label"><strong>Safe Zone:</strong></label>
      <select id="mover-safezone" disabled>
        <option value="homestead">Homestead</option>
        <option value="guildhall">Guild Hall</option>
      </select>
    </div>

    <div class="grid3">
      <div>
        <label class="mover-label">Main Decorations XML</label>
        <div class="drop-zone">
          <div class="drop-zone-icon">ðŸ“„</div>
          <div class="drop-zone-text">Drop XML here or click to browse</div>
          <input type="file" id="mover-main" accept=".xml">
        </div>
      </div>

      <div>
        <label class="mover-label">Start Location XML</label>
        <div class="drop-zone">
          <div class="drop-zone-icon">ðŸ“„</div>
          <div class="drop-zone-text">Drop XML here or click to browse</div>
          <input type="file" id="mover-start" accept=".xml">
        </div>
      </div>

      <div>
        <label class="mover-label">End Location XML</label>
        <div class="drop-zone">
          <div class="drop-zone-icon">ðŸ“„</div>
          <div class="drop-zone-text">Drop XML here or click to browse</div>
          <input type="file" id="mover-end" accept=".xml">
        </div>
      </div>
    </div>

    <button id="runMoverBtn">Move Decorations</button>

    <div class="video-section">
      <div class="video-caption">Instructional Video for the Deco Mover Tool:</div>
      <a class="video-link" href="https://youtu.be/OkFAmKErguY" target="_blank">
        â–¶ Watch on YouTube
      </a>
    </div>
  </div>

  <!-- ==================================================
       INTERACTIVE MOVE TOOL
       ================================================== -->
  <div id="tool-interactive-mover" class="tool-pane">

    <div class="section-title">Interactive Move Tool (Beta)</div>

    <div class="note-box">
      The Interactive Move Tool is the next level in decoration repositioning. No more placing boxes to determin start and end location for your decoration group XML file. With this tool, simply load your XML, move your character exactly where you want it centered, and click the Move buttons! It's so simple that it can even reposition a decoration cross-map (must be matching map type).<br><br>
      Set your anchor point to the bottom, middle or top of your decoration file for a more custom approach. There will be more fine-tuning coming in the future, but it doesn't get any easier than this!<br><br>
      <em>This tool utilizes our Deco Tools Helper Desktop App. To use this feature, you must download and run the app on your computer in the background with the game running to get accurate positional data. <a href="https://github.com/Girbilcannon/DecoToolsHelper/releases" target=_blank>CLICK HERE</a> to download!</em>
    </div>

    <div>
      <label>Decorations XML</label>
      <div class="drop-zone">
        <div class="drop-zone-icon">ðŸ“„</div>
        <div class="drop-zone-text">Drop XML here or click to browse</div>
        <input type="file" id="interactive-xml" accept=".xml">
      </div>
    </div>

    <div class="anchor-row">
      <label><strong>Vertical Anchor (Z):</strong></label><br>

      <label><input type="radio" name="z-anchor" value="bottom" checked> Bottom</label>
      <label><input type="radio" name="z-anchor" value="middle"> Middle</label>
      <label><input type="radio" name="z-anchor" value="top"> Top</label>

      <div class="anchor-note">
        Determines which part of the layout aligns to character position.
      </div>
    </div>

    <button id="interactive-move-btn">Move to Character Position</button>
    <div id="interactive-status"></div>
  </div>

  <!-- ==================================================
       COUNTER
       ================================================== -->
  <div id="tool-counter" class="tool-pane">

    <div class="section-title">Deco Counter Tool</div>

    <div class="note-box">
      Upload a saved layout to see how many of each decoration your Guild Hall or Homestead requires.<br><br>
      This tool offers more when you use our <a href="https://github.com/Girbilcannon/DecoToolsHelper/releases" target=_blank>Deco Tools Helper</a> Desktop App, including accurate Guild and Homestead decoration counts available on your account.
    </div>

    <div>
      <label>Decorations XML</label>
      <div class="drop-zone">
        <div class="drop-zone-icon">ðŸ“„</div>
        <div class="drop-zone-text">Drop XML here or click to browse</div>
        <input type="file" id="counter-xml" accept=".xml">
      </div>
    </div>

    <div class="counter-controls">
      <button id="runCounterBtn">Count Decorations</button>

      <div id="counter-guild-wrap" hidden>
        <label for="counter-guild">Guild:</label>
        <select id="counter-guild" disabled>
          <option value="">Select a guildâ€¦</option>
        </select>
      </div>
    </div>

    <pre id="counter-output"></pre>
    <button id="downloadCounter" style="display:none;">Download List</button>
  </div>

  <!-- ==================================================
       MAP SWAP
       ================================================== -->
  <div id="tool-swap" class="tool-pane">

    <div class="section-title">Map Swap Tool</div>

    <div class="note-box">
      Easily swap your map from Homestead to Homestead or Guild Hall to Guild Hall without breaking a sweat.
    </div>

    <div>
      <label>Homestead Decorations XML</label>
      <div class="drop-zone">
        <div class="drop-zone-icon">ðŸ“„</div>
        <div class="drop-zone-text">Drop XML here or click to browse</div>
        <input type="file" id="swap-xml" accept=".xml">
      </div>
    </div>

    <div class="map-choice-label"><strong>Select Target Map:</strong></div>
    <label><input type="radio" name="mapChoice" value="hearth" checked> Hearth's Glow</label><br>
    <label><input type="radio" name="mapChoice" value="comosus"> Comosus Isle</label><br>
    <label><input type="radio" name="mapChoice" value="lost"> Lost Precipice</label><br>
    <label><input type="radio" name="mapChoice" value="gilded"> Gilded Hollow</label><br>
    <label><input type="radio" name="mapChoice" value="windswept"> Windswept Haven</label><br>
    <label><input type="radio" name="mapChoice" value="isle"> Isle of Reflection</label><br><br>

    <button id="runSwapBtn">Swap Map</button>
  </div>

  <!-- =========================
     TAB: MERGE TOOL
     ========================= -->
  <div id="tool-merger" class="tool-pane">
    <div class="section-title">Deco Merge Tool</div>

    <div class="note-box">
    Merge multiple decoration XML layouts together safely, without any map type mix-up or going over your Deco Caps.
    <br><br>
    Unlock this tool's full potential by using our free <a href="https://github.com/Girbilcannon/DecoToolsHelper/releases" target=_blank>Deco Tools Helper</a> Desktop App!
    </div>

    <!-- ORIGINAL XML (BASE FILE) -->
    <div>
      <label>Original Decorations XML (Base Layout)</label>
      <div class="drop-zone">
        <div class="drop-zone-icon">ðŸ“„</div>
        <div class="drop-zone-text">Drop XML here or click to browse</div>
        <input type="file" id="merge-original" accept=".xml">
      </div>
    </div>

    <!-- ADDITIONAL XML FILES -->
    <div style="margin-top: 14px;">
      <label>Add Decorations XML (One or More)</label>
      <div class="drop-zone">
        <div class="drop-zone-icon">ðŸ“„+</div>
        <div class="drop-zone-text">Drop XML(s) here or click to browse</div>
        <input type="file" id="merge-add" accept=".xml" multiple>
      </div>
    </div>

    <!-- ACTION ROW (matches Counter layout: button + guild to the right) -->
    <div class="counter-controls" style="margin-top: 18px;">
      <button id="runMergeBtn" disabled>Merge Decorations</button>

      <div id="merge-guild-wrap" hidden>
        <label for="merge-guild">Guild:</label>
        <select id="merge-guild" disabled>
          <option value="">Select a guildâ€¦</option>
        </select>
      </div>
    </div>

    <!-- OUTPUT / READOUT -->
    <pre id="merge-output"></pre>
  </div>

  <!-- ==================================================
       EXTRACTION
       ================================================== -->
  <div id="tool-extract" class="tool-pane">
    <div class="section-title">Deco Extraction Tool</div>
    <div class="note-box">Not 100% sure about that last merge you did but don't feel like going through the mere process again? Or do you simple just want to pull a single group to be it's own file again? Eithe way, if you or someone previously used our Merge tool to build an XML layout, simple drop it in here and select the files you wish to extract.</div>

    <div>
      <label>Merged Decorations XML</label>
      <div class="drop-zone">
        <div class="drop-zone-icon">ðŸ“„</div>
        <div class="drop-zone-text">Drop XML here or click to browse</div>
        <input type="file" id="extract-xml" accept=".xml">
      </div>
    </div>

    <button id="viewExtractGroupsBtn">View Deco Groups</button>
    <div id="extract-groups"></div>
    <button id="extractSelectedGroupsBtn">Extract Selected Groups</button>
  </div>

  <!-- ==================================================
       INSPECTOR
       ================================================== -->
  <div id="tool-inspector" class="tool-pane">
    <div class="section-title">XML Inspector</div>
    <div class="note-box">Check and fix basic XML formatting errors. Sometimes this requires manual formatting, but this tool will provide you with a good starting point.</div>

    <div>
      <label>XML to Inspect</label>
      <div class="drop-zone">
        <div class="drop-zone-icon">ðŸ“„</div>
        <div class="drop-zone-text">Drop XML here or click to browse</div>
        <input type="file" id="inspector-xml" accept=".xml">
      </div>
    </div>

    <button id="runInspectorBtn">Inspect</button>
    <pre id="inspector-output"></pre>
    <button id="inspector-fixbtn" disabled>Fix Now</button>
  </div>

  <!-- ==================================================
       ABOUT
       ================================================== -->
  <div id="tool-about" class="tool-pane">
    <div class="section-title">About / Credits</div>
    <div class="note-box">
      <strong>GW2 Deco Tools</strong> is a project dedicated to the Guild Wars 2 community, for those who take Homestead/Guild Hall decorating seriously and need those extra bit of tools <em>not</em> provided in-game. All tools available on this site are 100% free to use and do not require the use of our external Helper application, though it is available to unlock extended tool capabilities.

      <h3>Secure Workflow</h3>
      <p>With <strong>GW2 Deco Tools</strong> you don't need to worry about hacked accounts, site corruption, data breaches, or anything of the sorts because the page is 100% static served with rock-solid security policy. This meaning, there is nothing happening on the back-end at the server level. What you see is served directly to you and your browser does the heavy lifting. Even the XML files you upload never leave your local browser.</p>

      <h3>Deco Tools Helper App</h3>
      <p>With <strong>Deco Tools Helper</strong> (not required), you unlock so much more of tools than ever possible before. Think of this stand-alone app as a "bridge" that runs securely and silently in the background, locally on your computer. This bridge has the ability to gain access to the local information shared by your GW2 game client such as current map and 3D position data. It also has access to locked API data that gets retrieved when one of the tools calls upon it, allowing you to get access to things like basic decoration counts.</p>

      <p>This app, like all of our tools, only runs locally between the game and your browser, only pinging very specific GW2 API data and nothing else, and <em>only</em> when the tool you are using calls for it to do so. Even your private API key is stored locally on your computer. We give you the best of everything and take absolutely <em>nothing</em>> of yours.</p>

      <h3>Credits</h3>
      <p>
      <strong>Deco Tools for Guild Wars 2</strong><br>
      Created by <strong>Pew!</strong> (Girbilcannon.8259)<br><br>
      <strong>Deco Tools Helper Project</strong><br>
      Created by <strong>Pew!</strong><br>
      Integrated using <strong>ChatGPT.</strong>
      </p>
    </div>
  </div>

  <div class="footer" id="footerText">
    GW2 Deco Tools â€¢ by Pew! â€¢ Powered by The Inquest
  </div>

</div>

<!-- ==================================================
     SCRIPTS
     ================================================== -->
<script src="utils.js"></script>
<script src="tabs.js"></script>
<script src="mover.js"></script>
<script src="interactiveMover.js"></script>
<script src="counter.js"></script>
<script src="swap.js"></script>
<script src="merge.js"></script>
<script src="extract.js"></script>
<script src="xmlinspector.js"></script>
<script src="helperStatus.js"></script>

</body>
</html>
